---
'title': '发送邮件和后台线程'
'date': 2016-10-09
---
# 发送邮件和后台线程

今天主要学习了利用 Python 的 smtplib 登录qq服务器发送邮件，以及利用 threading 中的Thread类建立后台线程，让一些花费时间较长，和用户下一步需求不是十分相关的任务在后台完成，不影响整个网站运行的流畅。

用到的主要模块：

- smtplib
- email.header.Header
- email.mime.text.MIMEText
- threading.Thread

首先，登录qq server的信息，可以保存在一个单独文件中，包括用户名和登录令牌，端口，主机地址。

然后导入这些信息实现qq server 的登录。

要发送的信息需要 email 打包，具体包括 from\_addr, to\_addr, subject, body。更高级的话，还可以在 body 里分为纯文本，html 网页和附件。

其余的就是参考相关博客和教程，注意细节。

此外，还解决了一个困扰许久且很蛋疼的问题：Windows 平台下 raw\_input 如何处理汉语提示和汉语输入的问题。要解决的就是将 unicode 格式的提示编码为 GBK 字符串，将 GBK 编码的输入字符串解码为 unicode 字符串，再进行其它转换。

对于后台线程，就是利用 threading 里打包好的 Thread 类，传入目标函数，以及其它相关参数，并且设定 daemon 守护线程。