---
'title': '最最基础的重构代码'
'date': 2018-11-29
---
# 最最基础的重构代码

今天干了一点最最基础的代码重构工作。

将一个 Django app 分离为两个。

使用的 vscode 编辑器未提供重构代码的便捷方式（或者我没有找到）。

最终只能手动修改。

同时也把 xadmin 中的 app 分离了一下，并优化了一下资产导入的逻辑。

通过这次基础的代码重构，对 Django 的代码结构有了更进一步的认识。

有一个 app.py 文件负责配置 app 路径，在项目的 settings.py 中统一管理各个 app 以及其它各种配置。

遇到问题及时请教同事，不要让不必要的东西阻碍自己的工作流程。

在重构过程中，自己解决掉了一个外键关联 User 表发生错误的问题。

通过自己的思考，找到了解决方案：移除已有的 migrations 文件即可。

再者，通过阅读同事的代码，学习到一个添加缓存数据的好方法。

通过定制 serializer 和 view，将存值和取值的操作对应到缓存的设置和读取上。

重点是重写 serializer 的 create 和 update 方法，以及 viewsets 的 get\_object 方法。