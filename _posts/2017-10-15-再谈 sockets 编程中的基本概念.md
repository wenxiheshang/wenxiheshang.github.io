---
'title': '再谈 sockets 编程中的基本概念'
'date': 2017-10-15
---
# 再谈 sockets 编程中的基本概念

上一次，主要谈了三个点：
- sockets 作为跨平台的 IPC 形式中的唯一玩家，负责在应用层的底层驱动着整个互联网的通信 
- 通信模式一般为「服务端-客户端」，端到端
- 通常为 block 模式，需要利用 thread 或 select 实现非阻塞

这一次，再谈一些更具体的概念：

- 动作与持续行为
	- 在通讯被搭建起来的整个过程中，socket 有时执行一个动作，有时执行一个行为，行为往往是持续的。动作改变 socket 所处的状态，行为可以返回结果，结果可以多种多样
- 网络字节和本级字节的相互转换
	- 不同硬件，甚至不同协议下的数据很可能具备不一样的字节
	- 在网络通讯中，字节转换必然是一个频繁现象
- socket 与 TCP／IP 协议
	- 协议本身与 socket 这个具体实现无关
	- socket 的实现却需要在某种协议下进行
	- TCP／IP 协议下的 sockets 通讯，本质上两个携带 IP／PORT 地址的 socket 线程之间的通讯
- 基于 stream 的 TCP 简易通讯模型
	- TCP 连接通过三次握手实现，需要各自建立连接，也需要各自断开
	- 连接一旦建立，便是持续性的
	- 连接实现为在物理上开放，在抽象上封闭的双向管道模式
	- 数据包的发送和接收实际上是非连续的，网络层 IP 协议不保证数据包一定抵达，也不保证数据包按先后次序抵达，这种在实际通讯中必须得到的保证是由传输协议 TCP 实现的
- 服务端
	- 创建 socket ，绑定特定地址到 socket ，命令 已经携带地址的 socket 进入监听状态，命令监听状态下的 socket 执行 accept 行为，行为的目标是新建一个同时携带服务端地址与客户端地址的 socket，并以 socket 接收客户端 socket 的请求数据，处理请求之后，发送响应到客户端 socket 
- 客户端
	- 创建 socket，发起 connect ，将本地 socket 绑定到网络中的另一个 socket 之上，之后可以开始发送并接收数据，最后可以关闭连接
- IP 与 域名
	- 一个 IP 下某个端口下的进程可以与另一个 IP 下某个端口下的进程进行通讯
	- 在浏览器中，我们输入一个域名后，域名将会被解析为某个 IP 地址
	- 域名解析完全是为了服务人